!function(t){var e={};function i(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)i.d(s,h,function(e){return t[e]}.bind(null,h));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=1)}([function(t,e,i){t.exports={srcSet:i.p+"c8916e9399f77bcabad58b38735bdf92-400.png 400w,"+i.p+"2171a068efb5798f56d727832a1d3674-600.png 600w,"+i.p+"9cd70ca18db3432d075da4f50a81843a-800.png 800w,"+i.p+"28cf8908963ab6dec232c2ee95d0b772-1000.png 1000w,"+i.p+"1078d4e44ee67289b6beaab5b4f3a2f7-1200.png 1200w,"+i.p+"12df58b1e371fd564fa70bc752b9681b-1500.png 1500w,"+i.p+"24afda234cbc9678037e04ee3f1ef1c0-2000.png 2000w,"+i.p+"3355a22ba9d2c939f9b9e710eb96b3dd-2500.png 2500w",images:[{path:i.p+"c8916e9399f77bcabad58b38735bdf92-400.png",width:400,height:400},{path:i.p+"2171a068efb5798f56d727832a1d3674-600.png",width:600,height:600},{path:i.p+"9cd70ca18db3432d075da4f50a81843a-800.png",width:800,height:800},{path:i.p+"28cf8908963ab6dec232c2ee95d0b772-1000.png",width:1e3,height:1e3},{path:i.p+"1078d4e44ee67289b6beaab5b4f3a2f7-1200.png",width:1200,height:1200},{path:i.p+"12df58b1e371fd564fa70bc752b9681b-1500.png",width:1500,height:1500},{path:i.p+"24afda234cbc9678037e04ee3f1ef1c0-2000.png",width:2e3,height:2e3},{path:i.p+"3355a22ba9d2c939f9b9e710eb96b3dd-2500.png",width:2500,height:2500}],src:i.p+"c8916e9399f77bcabad58b38735bdf92-400.png",toString:function(){return i.p+"c8916e9399f77bcabad58b38735bdf92-400.png"},placeholder:void 0,width:400,height:400}},function(t,e,i){t.exports=i(3)},function(t,e,i){},function(t,e,i){"use strict";i.r(e);i(2),i.p,i.p,i.p;var s=i(0);const h=i.n(s).a,n=document.getElementById("puzzle"),o=document.getElementById("puzzle-image"),a=n.clientWidth*(window.devicePixelRatio||1),r=h.images.find(t=>t.width>a);o.setAttribute("xlink:href",r.path);const d=(t,e)=>(void 0===t?(t=0,e=1):void 0===e&&(e=t,t=0),Math.random()*(e-t)+t),c=(t,e,i)=>{if(i<e){var s=e;e=i,i=s}return Math.max(e,Math.min(t,i))};class p{constructor(t,e){this.reset=(t,e)=>(this.x=t,this.y=e,this),this.toString=t=>{t=t||3;const e=Math.pow(10,t);return`${Math.round(this.x*e)/e}, ${Math.round(this.y*e)/e}]`},this.clone=()=>new p(this.x,this.y),this.copyTo=t=>{t.x=this.x,t.y=this.y},this.copyFrom=t=>{this.x=t.x,this.y=t.y},this.magnitude=()=>Math.sqrt(this.x*this.x+this.y*this.y),this.magnitudeSquared=()=>this.x*this.x+this.y*this.y,this.normalise=()=>{const t=this.magnitude();return this.x=this.x/t,this.y=this.y/t,this},this.reverse=()=>(this.x=-this.x,this.y=-this.y,this),this.plusEq=t=>(this.x+=t.x,this.y+=t.y,this),this.plusNew=t=>new p(this.x+t.x,this.y+t.y),this.minusEq=t=>(this.x-=t.x,this.y-=t.y,this),this.minusNew=t=>new p(this.x-t.x,this.y-t.y),this.multiplyEq=t=>(this.x*=t,this.y*=t,this),this.multiplyNew=t=>this.clone().multiplyEq(t),this.divideEq=t=>(this.x/=t,this.y/=t,this),this.divideNew=t=>this.clone().divideEq(t),this.dot=t=>this.x*t.x+this.y*t.y,this.angle=t=>Math.atan2(this.y,this.x)*(t?u.TO_DEGREES:1),this.rotate=(t,e)=>{const i=Math.cos(t*(e?u.TO_RADIANS:1)),s=Math.sin(t*(e?u.TO_RADIANS:1));return u.temp.copyFrom(this),this.x=u.temp.x*i-u.temp.y*s,this.y=u.temp.x*s+u.temp.y*i,this},this.equals=t=>this.x===t.x&&this.y===t.y,this.isCloseTo=(t,e)=>!!this.equals(t)||(u.temp.copyFrom(this),u.temp.minusEq(t),u.temp.magnitudeSquared()<e*e),this.rotateAroundPoint=(t,e,i)=>{u.temp.copyFrom(this),u.temp.minusEq(t),u.temp.rotate(e,i),u.temp.plusEq(t),this.copyFrom(u.temp)},this.isMagLessThan=t=>this.magnitudeSquared()<t*t,this.isMagGreaterThan=t=>this.magnitudeSquared()>t*t,this.dist=t=>this.minusNew(t).magnitude(),this.x=t||0,this.y=e||0}}const u={TO_DEGREES:180/Math.PI,TO_RADIANS:Math.PI/180,temp:new p};var l=p;const m=new Path2D("M-5 1c-.6 0-1-.4-1-1s.4-1 1-1c4 0 4-5 4-7 0-.6.4-1 1-1s1 .4 1 1c0 2 0 7 4 7 .6 0 1 .4 1 1s-.4 1-1 1C1 1 1 6 1 8c0 .6-.4 1-1 1s-1-.4-1-1c0-2 0-7-4-7z");class f{constructor({canvasWidth:t,canvasHeight:e,start:i}){this.canvasWidth=t,this.canvasHeight=e,this.x=0,this.y=0,this.scale=0,this.through=i,this.speed=d(.005,.015),this.position()}position(){const t=Math.pow(d(.75,1.5),3);this.x=d(12*t,this.canvasWidth-12*t),this.y=d(18*t,this.canvasHeight-18*t),this.scale=t}draw(t){if(this.through<0)return;t.save(),t.translate(this.x,this.y);const e=(i=Math.pow(Math.sin(this.through*Math.PI),2),s=0,h=1,n=.5*this.scale,o=this.scale,r=(i-s)/(h-s)*(o-n)+n,a?c(r,n,o):r);var i,s,h,n,o,a,r;t.globalAlpha=Math.sin(this.through*Math.PI),t.scale(e,e),t.fill(m),t.restore()}update(){this.through+=this.speed,this.through>=1&&(this.position(),this.through=0)}}const y=[],g=()=>{const t=document.getElementById("puzzle-celebration"),{clientWidth:e,clientHeight:i}=t,s=window.devicePixelRatio||1;t.width=e*s,t.height=i*s;const h=t.getContext("2d");h.scale(s,s),h.fillStyle="white";for(let t=0;t<20;t++)y.push(new f({canvasWidth:e,canvasHeight:i,start:-t/10}));const n=()=>{h.clearRect(0,0,e,i),y.forEach(t=>{t.update(),t.draw(h)}),requestAnimationFrame(n)};requestAnimationFrame(n)},x=(t,e=0)=>{const{top:i,left:s,width:h,height:n}=t.getBoundingClientRect();return{top:i-e,left:s-e,width:h+2*e,height:n+2*e}},b=window.innerWidth,w=window.innerHeight,v=b<w?b:w,M=document.getElementById("puzzle"),E=Array.from(document.getElementsByClassName("js-avoid")).map(t=>x(t,Math.min(.03*v,20))),q={screenWidth:b,screenHeight:w,screenMin:v,avoidBoxes:[x(M,Math.min(.03*v,30)),...E],puzzleBox:x(M),puzzle:M,paths:document.querySelectorAll("#puzzle path"),viewBox:{x:1e3,y:1e3}},P=[],z=t=>{Array.from(t.touches).forEach(t=>{const e=document.elementFromPoint(t.pageX,t.pageY);if(!e)return;const i=e.getAttribute("index");i&&S(parseInt(i))})};document.addEventListener("touchmove",z);const S=t=>{const{paths:e}=q;if(-1!==P.indexOf(t))return;P.push(t);const i=e[t];P.length===e.length&&A(i);i.parentNode.appendChild(i),window.setTimeout(()=>{i.style.removeProperty("transform")},50)},A=t=>{document.removeEventListener("touchmove",z);const e=parseInt(t.style.getPropertyValue("--transition-speed"));window.setTimeout(()=>{document.body.style.removeProperty("cursor")},e),window.setTimeout(g,e)},B=[],T=(t,e)=>{const{screenWidth:i,screenHeight:s,avoidBoxes:h}=q;if(t.x<0||t.x>i)return!1;if(t.y<0||t.y>s)return!1;if(h.some(e=>t.x>e.left&&t.x<e.left+e.width&&t.y>e.top&&t.y<e.top+e.height))return!1;if(e>0){if(B.some(i=>t.dist(i)<e))return!1}return!0},I=new l(0,1),N=(t,e)=>t.plusNew(I.normalise().multiplyEq(d(0,e)).rotate(d(0,Math.PI))),O=()=>{const{screenWidth:t,screenHeight:e,avoidBoxes:i,puzzleBox:s,puzzle:h,paths:n,viewBox:o}=q,{top:a,left:r,width:d,height:p}=s,u=new l(r+d/2,a+p/2),m=d/2+10,f=n.length,y=i.reduce((t,{width:e,height:i})=>t-e*i,t*e);let g=Math.max(d/Math.sqrt(f),.5*Math.sqrt(y/f));for(let i=0;i<f;i++){const s=n[i],{x:h,y:f,width:y,height:w}=s.getBBox(),v=f+w/2,M=(h+y/2)/o.x,E=v/o.y,q=new l(r+M*d,a+E*p),P=q.minusNew(u),z=P.magnitude();P.normalise();const S=m/Math.max(Math.abs(P.x),Math.abs(P.y))-z,A=P.multiplyEq(2.2*S),I=q.plusNew(A);I.x<0&&(I.x=0),I.x>t&&(I.x=t),I.y<0&&(I.y=0),I.y>e&&(I.y=e);const O=.5*S+20;let _=N(I,O),j=1;for(;!T(_,g-j/20)&&j<500;)j++,_=N(_,O+j/20);500===j&&(_=I),B.push(_);const F=_.minusNew(q).divideEq(d);n[i].style.setProperty("transform-origin",`${(100*M).toFixed(3)}% ${(100*E).toFixed(3)}%`),n[i].style.setProperty("transform",`translate(${100*F.x}%, ${100*F.y}%) rotate(${x=50,b=100,void 0===b&&(b=x,x=0),(Math.floor(Math.random()*(b+1-x))+x)*(Math.random()<.5?-1:1)}deg)`),setTimeout(()=>{n[i].style.setProperty("transition",`transform ${Math.floor(c(1e3*F.magnitude(),200,400))}ms ease`)},100)}var x,b;(()=>{const{paths:t}=q;document.body.style.setProperty("cursor","crosshair"),t.forEach((t,e)=>{t.setAttribute("index",String(e)),t.addEventListener("mouseenter",()=>{S(e)},{once:!0})})})(),h.classList.remove("js-hidden"),matchMedia("(hover: none)").matches&&(()=>{const{paths:t}=q;t.forEach((t,e)=>{setTimeout(()=>S(e),1e3+150*e)})})()},{matches:_}=window.matchMedia("(prefers-reduced-motion: reduce)");if(_){const t=document.getElementById("puzzle");null==t||t.classList.remove("js-hidden")}else window.addEventListener("load",O)}]);
//# sourceMappingURL=main.js.map